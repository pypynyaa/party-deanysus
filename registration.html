<!DOCTYPE html>
<html lang="ru">
<head>
  <!-- Test comment for Git tracking -->
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Регистрация на Party Dionysus</title>
  
  <!-- Предварительная загрузка изображений -->
  <link rel="preload" as="image" href="volleyball.jpg">
  <link rel="preload" as="image" href="basketball.jpg">
  <link rel="preload" as="image" href="football.jpg">
  <link rel="preload" as="image" href="tennis.jpg">
  <link rel="preload" as="image" href="mcqueen.jpg">
  <link rel="preload" as="image" href="mater.jpg">
  <link rel="preload" as="image" href="chat.jpg">
  
  <link rel="stylesheet" href="registration.css?v=3">
</head>
<body>
  <div class="video-background">
    <video autoplay muted loop playsinline id="bgVideo">
      <source src="фонтоп.mp4" type="video/mp4">
    </video>
  </div>
  <div class="container">
    <form id="registrationForm" class="registration-form">
      <h1>Регистрация на вечеринку</h1>
      
      <div class="form-section">
        <h2>Основная информация</h2>
        <div class="form-grid">
          <div class="form-group">
            <input type="text" id="fullName" name="fullName" required>
            <label for="fullName">ФИО</label>
          </div>
          <div class="form-group">
            <input type="tel" id="phone" name="phone" required>
            <label for="phone">Номер телефона</label>
          </div>
          <div class="form-group">
            <input type="text" id="telegram" name="telegram" required>
            <label for="telegram">Ссылка на Telegram</label>
          </div>
        </div>

        <h2>Оплата</h2>
        <div class="form-group payment-section">
          <div class="payment-info">
            <p class="payment-details">Реквизиты для оплаты:</p>
            <p class="payment-card">5469 4500 1062 9285</p>
            <p class="payment-name">Никита Н.</p>
            <p class="payment-bank">Сбербанк</p>
          </div>
          <label class="checkbox-label">
            <input type="checkbox" id="paymentDone" name="paymentDone">
            <span>Я оплатил участие</span>
          </label>
          <div class="form-group payment-proof hidden">
            <input type="file" id="paymentProof" name="paymentProof" accept="image/*,.pdf,.doc,.docx">
            <div class="file-upload-container">
              <label for="paymentProof" class="file-upload-label">
                <span class="file-name">Прикрепить файл оплаты</span>
              </label>
              <button type="button" class="delete-file hidden" onclick="removeFile()">×</button>
            </div>
            <div class="image-preview hidden">
              <img id="previewImage" src="#" alt="Предпросмотр">
              <div class="preview-overlay">
                <span class="preview-text">Файл добавлен</span>
              </div>
            </div>
          </div>
        </div>

        <h2>Как доберешься?</h2>
        <div class="transport-options">
          <label class="transport-option">
            <input type="radio" name="transport" value="self" required>
            <div class="transport-card">
              <img src="mcqueen.jpg" alt="Своя машина">
              <span>Еду сам / с друзьями</span>
            </div>
          </label>
          <label class="transport-option">
            <input type="radio" name="transport" value="bus" required>
            <div class="transport-card">
              <img src="mater.jpg" alt="Автобус">
              <span>Еду со всеми на автобусе</span>
            </div>
          </label>
        </div>

        <div class="form-group license-group hidden">
          <label class="checkbox-label">
            <input type="checkbox" id="hasLicense" name="hasLicense">
            <span>Есть водительские права</span>
          </label>
        </div>

        <h2>Активности</h2>
        <div class="activities-grid">
          <label class="activity-option">
            <input type="checkbox" name="activities" value="basketball">
            <div class="activity-card">
              <img src="basketball.jpg" alt="Баскетбол">
            </div>
          </label>
          <label class="activity-option">
            <input type="checkbox" name="activities" value="football">
            <div class="activity-card">
              <img src="football.jpg" alt="Футбол">
            </div>
          </label>
          <label class="activity-option">
            <input type="checkbox" name="activities" value="volleyball">
            <div class="activity-card">
              <img src="volleyball.jpg" alt="Волейбол">
            </div>
          </label>
          <label class="activity-option">
            <input type="checkbox" name="activities" value="tennis">
            <div class="activity-card">
              <img src="tennis.jpg" alt="Теннис">
            </div>
          </label>
        </div>

        <h2>Дополнительные активности</h2>
        <div class="other-activities">
          <label class="checkbox-label">
            <input type="checkbox" id="sauna" name="sauna">
            <span>Пойду в баню</span>
          </label>
          <label class="checkbox-label">
            <input type="checkbox" id="hideAndSeek" name="hideAndSeek">
            <span>Буду играть в прятки</span>
          </label>
        </div>

        <h2>Дополнительная информация</h2>
        <div class="form-grid">
          <div class="form-group">
            <select id="relationship" name="relationship" required>
              <option value="">Выберите статус</option>
              <option value="single">Свободен/Свободна</option>
              <option value="relationship">Есть вторая половинка</option>
            </select>
          </div>
          <div class="form-group full-width">
            <div id="musicLinks" class="music-links">
              <div class="music-link-container">
                <input type="text" class="music-input" name="music[]" placeholder="Ссылка на трек в Яндекс.Музыке">
                <button type="button" class="add-music-btn">+</button>
              </div>
            </div>
          </div>
          <div class="form-group full-width">
            <select id="camera" name="camera" required>
              <option value="">Есть ли у вас фото/видео оборудование?</option>
              <option value="none">Нет оборудования</option>
              <option value="phone">Телефон с хорошей камерой</option>
              <option value="photo">Фотоаппарат</option>
              <option value="video">Видеокамера</option>
              <option value="both">И фото, и видео оборудование</option>
            </select>
          </div>
          <div class="form-group full-width">
            <textarea id="foodPreferences" name="foodPreferences" placeholder="Предпочтения по еде (аллергии, вегетарианство и т.д.)"></textarea>
          </div>
        </div>
        
        <button type="submit" class="submit-btn">Отправить</button>
      </div>
    </form>
  </div>

  <div class="chat-button" onclick="window.location.href='chat.html'">
    <img src="chat.jpg" alt="Чат">
  </div>

  <div class="chat-popup hidden" id="chatPopup">
    <div class="chat-header">
      <span>Чат поддержки</span>
      <button class="close-chat" onclick="toggleChat()">×</button>
    </div>
    <div class="chat-messages" id="chatMessages">
      <div class="message system">Задайте ваш вопрос</div>
    </div>
    <div class="chat-input">
      <input type="text" id="messageInput" placeholder="Введите сообщение...">
      <button onclick="sendMessage()">Отправить</button>
    </div>
  </div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-storage.js"></script>
  
  <!-- Инициализация Firebase -->
  <script>
    // Глобальная функция для инициализации базы данных
    window.initializeFirebase = function() {
      return new Promise((resolve, reject) => {
        try {
          // Проверяем, что все необходимые компоненты Firebase загружены
          if (typeof firebase === 'undefined') {
            reject(new Error('Firebase SDK не загружен'));
            return;
          }
          console.log('Firebase SDK успешно загружен');

          // Конфигурация Firebase
          const firebaseConfig = {
            apiKey: "AIzaSyCZgzf39KPvFoR-0Tg33TjypbjK-dxiUVI",
            authDomain: "party-registration-web.firebaseapp.com",
            projectId: "party-registration-web",
            storageBucket: "party-registration-web.firebasestorage.app",
            messagingSenderId: "437696239321",
            appId: "1:437696239321:web:ea38f2ed5d3cd75434d0c8",
            measurementId: "G-FBKQXVRD0D"
          };

          // Инициализация Firebase
          firebase.initializeApp(firebaseConfig);
          console.log('Firebase успешно инициализирован');

          // Проверяем доступность Firestore
          if (firebase.firestore) {
            console.log('Firestore доступен');
            resolve(firebase.firestore());
          } else {
            reject(new Error('Firestore не доступен'));
          }
        } catch (error) {
          console.error('Ошибка при инициализации Firebase:', error);
          reject(error);
        }
      });
    };
    
    // Загружаем основной скрипт
    const script = document.createElement('script');
    script.src = 'registration.js';
    script.onerror = function() {
      console.error('Ошибка загрузки registration.js');
    };
    script.onload = function() {
      console.log('registration.js успешно загружен');
    };
    document.body.appendChild(script);
  </script>
</body>
</html>
